<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>NCEAS Data Team Reference Guide - Edit EML</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./pi_correspondence.html" rel="next">
<link href="./explore_eml.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Edit EML</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Team <br> Reference Guide</a> 
        <div class="sidebar-tools-main">
    <a href="https://arcticdata.io" title="Arctic Data Center" class="sidebar-tool px-1"><i class="bi bi-house-door-fill"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./miscellaneous.html" class="sidebar-item-text sidebar-link">Miscellaneous</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./edit_data_packages.html" class="sidebar-item-text sidebar-link">Edit Data Packages</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore_eml.html" class="sidebar-item-text sidebar-link">Explore EML</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./edit_eml.html" class="sidebar-item-text sidebar-link active">Edit EML</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pi_correspondence.html" class="sidebar-item-text sidebar-link">PI Correspondence</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc_file_types.html" class="sidebar-item-text sidebar-link">Miscellaneous file types</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangle_data.html" class="sidebar-item-text sidebar-link">Wrangle Data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solr_queries.html" class="sidebar-item-text sidebar-link">Solr Queries</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./adc_web_submissions.html" class="sidebar-item-text sidebar-link">ADC Web Submissions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_portals.html" class="sidebar-item-text sidebar-link">Data Portals</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_packages_arcticdatautils.html" class="sidebar-item-text sidebar-link">Using arcticdatautils</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nesting_data.html" class="sidebar-item-text sidebar-link">Nesting Data</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://nceas.github.io/datateam-training/training/" class="sidebar-item-text sidebar-link">Training Manual</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#edit-an-eml-element" id="toc-edit-an-eml-element" class="nav-link active" data-scroll-target="#edit-an-eml-element">Edit an EML element</a>
  <ul class="collapse">
  <li><a href="#edit-eml-with-strings" id="toc-edit-eml-with-strings" class="nav-link" data-scroll-target="#edit-eml-with-strings">Edit EML with strings</a></li>
  <li><a href="#edit-eml-with-the-eml-package" id="toc-edit-eml-with-the-eml-package" class="nav-link" data-scroll-target="#edit-eml-with-the-eml-package">Edit EML with the “EML” package</a></li>
  <li><a href="#edit-eml-with-objects" id="toc-edit-eml-with-objects" class="nav-link" data-scroll-target="#edit-eml-with-objects">Edit EML with objects</a></li>
  </ul></li>
  <li><a href="#edit-attributelists" id="toc-edit-attributelists" class="nav-link" data-scroll-target="#edit-attributelists">Edit attributeLists</a>
  <ul class="collapse">
  <li><a href="#edit-attributes" id="toc-edit-attributes" class="nav-link" data-scroll-target="#edit-attributes">Edit attributes</a></li>
  <li><a href="#edit-custom-units" id="toc-edit-custom-units" class="nav-link" data-scroll-target="#edit-custom-units">Edit custom units</a></li>
  <li><a href="#edit-factors" id="toc-edit-factors" class="nav-link" data-scroll-target="#edit-factors">Edit factors</a></li>
  <li><a href="#finalize-attributelist" id="toc-finalize-attributelist" class="nav-link" data-scroll-target="#finalize-attributelist">Finalize attributeList</a></li>
  </ul></li>
  <li><a href="#edit-custom-units-1" id="toc-edit-custom-units-1" class="nav-link" data-scroll-target="#edit-custom-units-1">Edit custom units</a></li>
  <li><a href="#edit-datatables" id="toc-edit-datatables" class="nav-link" data-scroll-target="#edit-datatables">Edit dataTables</a></li>
  <li><a href="#semantic-annotations" id="toc-semantic-annotations" class="nav-link" data-scroll-target="#semantic-annotations">Semantic annotations</a>
  <ul class="collapse">
  <li><a href="#how-annotations-are-used" id="toc-how-annotations-are-used" class="nav-link" data-scroll-target="#how-annotations-are-used">How annotations are used</a></li>
  <li><a href="#how-to-add-an-annotation" id="toc-how-to-add-an-annotation" class="nav-link" data-scroll-target="#how-to-add-an-annotation">How to add an annotation</a></li>
  <li><a href="#annotating-sensitive-data" id="toc-annotating-sensitive-data" class="nav-link" data-scroll-target="#annotating-sensitive-data">Annotating sensitive data</a></li>
  </ul></li>
  <li><a href="#edit-spatial-data" id="toc-edit-spatial-data" class="nav-link" data-scroll-target="#edit-spatial-data">Edit spatial data</a>
  <ul class="collapse">
  <li><a href="#reading-spatial-files" id="toc-reading-spatial-files" class="nav-link" data-scroll-target="#reading-spatial-files">Reading Spatial Files</a></li>
  <li><a href="#spatialvector" id="toc-spatialvector" class="nav-link" data-scroll-target="#spatialvector">spatialVector</a></li>
  <li><a href="#spatialrasters" id="toc-spatialrasters" class="nav-link" data-scroll-target="#spatialrasters">spatialRasters</a></li>
  </ul></li>
  <li><a href="#format-text-in-eml" id="toc-format-text-in-eml" class="nav-link" data-scroll-target="#format-text-in-eml">Format text in EML</a>
  <ul class="collapse">
  <li><a href="#type-setting" id="toc-type-setting" class="nav-link" data-scroll-target="#type-setting">Type-setting</a></li>
  <li><a href="#links" id="toc-links" class="nav-link" data-scroll-target="#links">Links</a></li>
  <li><a href="#lists" id="toc-lists" class="nav-link" data-scroll-target="#lists">Lists</a></li>
  </ul></li>
  <li><a href="#series-identifier-sid" id="toc-series-identifier-sid" class="nav-link" data-scroll-target="#series-identifier-sid">Series Identifier (SID)</a>
  <ul class="collapse">
  <li><a href="#adding-a-sid-to-a-package" id="toc-adding-a-sid-to-a-package" class="nav-link" data-scroll-target="#adding-a-sid-to-a-package">Adding a SID to a package</a></li>
  <li><a href="#updating-the-child-packages-of-a-parent-package-with-a-sid" id="toc-updating-the-child-packages-of-a-parent-package-with-a-sid" class="nav-link" data-scroll-target="#updating-the-child-packages-of-a-parent-package-with-a-sid">Updating the child packages of a parent package with a SID</a></li>
  <li><a href="#updating-the-metadata-of-a-package-with-a-sid" id="toc-updating-the-metadata-of-a-package-with-a-sid" class="nav-link" data-scroll-target="#updating-the-metadata-of-a-package-with-a-sid">Updating the metadata of a package with a SID</a></li>
  </ul></li>
  <li><a href="#set-coverages" id="toc-set-coverages" class="nav-link" data-scroll-target="#set-coverages">Set coverages</a>
  <ul class="collapse">
  <li><a href="#set-multiple-coverages" id="toc-set-multiple-coverages" class="nav-link" data-scroll-target="#set-multiple-coverages">Set multiple coverages</a></li>
  <li><a href="#special-coverages" id="toc-special-coverages" class="nav-link" data-scroll-target="#special-coverages">Special coverages</a></li>
  </ul></li>
  <li><a href="#set-methods" id="toc-set-methods" class="nav-link" data-scroll-target="#set-methods">Set methods</a>
  <ul class="collapse">
  <li><a href="#adding-sampling-info-to-methods-section" id="toc-adding-sampling-info-to-methods-section" class="nav-link" data-scroll-target="#adding-sampling-info-to-methods-section">Adding sampling info to methods section</a></li>
  </ul></li>
  <li><a href="#set-parties" id="toc-set-parties" class="nav-link" data-scroll-target="#set-parties">Set parties</a></li>
  <li><a href="#set-physical" id="toc-set-physical" class="nav-link" data-scroll-target="#set-physical">Set physical</a></li>
  <li><a href="#set-the-project-section" id="toc-set-the-project-section" class="nav-link" data-scroll-target="#set-the-project-section">Set the project section</a></li>
  <li><a href="#use-references" id="toc-use-references" class="nav-link" data-scroll-target="#use-references">Use references</a>
  <ul class="collapse">
  <li><a href="#example-with-parties" id="toc-example-with-parties" class="nav-link" data-scroll-target="#example-with-parties">Example with parties</a></li>
  <li><a href="#example-with-attributes" id="toc-example-with-attributes" class="nav-link" data-scroll-target="#example-with-attributes">Example with attributes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Edit EML</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="edit-an-eml-element" class="level2">
<h2 class="anchored" data-anchor-id="edit-an-eml-element">Edit an EML element</h2>
<p>There are multiple ways to edit an EML element.</p>
<section id="edit-eml-with-strings" class="level3">
<h3 class="anchored" data-anchor-id="edit-eml-with-strings">Edit EML with strings</h3>
<p>The most basic way to edit an EML element would be to navigate to the element and replace it with something else. Easy!</p>
<p>For example, to change the title one could use the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>title <span class="ot">&lt;-</span> <span class="st">"New Title"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the element you are editing allows for multiple values, you can pass it a list of character strings. Since a dataset can have multiple titles, we can do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>title <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"New Title"</span>, <span class="st">"Second New Title"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, this isn’t always the best method to edit the EML, particularly if the element has sub-elements.</p>
</section>
<section id="edit-eml-with-the-eml-package" class="level3">
<h3 class="anchored" data-anchor-id="edit-eml-with-the-eml-package">Edit EML with the “EML” package</h3>
<p>To edit a section where you are not 100% sure of the sub-elements, using the <code>eml$elementName()</code> helper functions from the EML package will pre-populate the options for you if you utilize the RStudio autocomplete functionality. The arguments in these functions show the available slots for any given EML element. For example, typing <code>doc$dataset$abstract &lt;- eml$abstract()&lt;TAB&gt;</code> will show you that the <code>abstract</code> element can take either the <code>section</code> or <code>para</code> sub-elements.</p>
<p><img src="../../images/eml_function_autocomplete.png" class="img-fluid"></p>
<p><img src="images/eml_function_autocomplete.png" class="img-fluid"></p>
<p><img src="./images/eml_function_autocomplete.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>abstract <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">abstract</span>(<span class="at">para =</span> <span class="st">"A concise but thorough description of the who, what, where, when, why, and how of a dataset."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This inserts the abstract with a <code>para</code> element in our dataset, which we know from the EML <a href="https://eml.ecoinformatics.org/schema/index.html">schema</a> is valid.</p>
<p>Note that the above is equivalent to the following generic construction:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>abstract <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">para =</span> <span class="st">"A concise but thorough description of the who, what, where, when, why, and how of a dataset."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>eml()</code> family of functions provides the sub-elements as arguments, which is extremely helpful, but functionally all it is doing is creating a named list, which you can also do using the <code>list</code> function.</p>
</section>
<section id="edit-eml-with-objects" class="level3">
<h3 class="anchored" data-anchor-id="edit-eml-with-objects">Edit EML with objects</h3>
<p>A final way to edit an EML element would be to build a new object to replace the old object. To begin, you might create an object using an <code>eml</code> helper function. Let’s take keywords as an example. Sometimes keyword lists in a metadata record will come from different thesauruses, which you can then add in series (similar to the way we added multiple titles) to the element <code>keywordSet</code>.</p>
<p>We start by creating our first set of keywords and saving it to an object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>kw_list_1 <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">keywordSet</span>(<span class="at">keywordThesaurus =</span> <span class="st">"LTER controlled vocabulary"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">keyword =</span> <span class="fu">list</span>(<span class="st">"bacteria"</span>, <span class="st">"carnivorous plants"</span>, <span class="st">"genetics"</span>, <span class="st">"thresholds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Which returns:</p>
<pre><code>$keyword
$keyword[[1]]
[1] "bacteria"

$keyword[[2]]
[1] "carnivorous plants"

$keyword[[3]]
[1] "genetics"

$keyword[[4]]
[1] "thresholds"


$keywordThesaurus
[1] "LTER controlled vocabulary"</code></pre>
<p>We create the second keyword list similarly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>kw_list_2 <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">keywordSet</span>(<span class="at">keywordThesaurus =</span> <span class="st">"LTER core area"</span>, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">keyword =</span>  <span class="fu">list</span>(<span class="st">"populations"</span>, <span class="st">"inorganic nutrients"</span>, <span class="st">"disturbance"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we can insert our two keyword lists into our EML document just like we did with the title example above, but rather than passing character strings into <code>list()</code>, we will pass our two keyword set objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>keywordSet <span class="ot">&lt;-</span> <span class="fu">list</span>(kw_list_1, kw_list_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that you <strong>must</strong> use the function <code>list</code> here and not the <code>c()</code> function. The reasons for this are complex, and due to some technical subtlety in R - but the gist of the issue is that the <code>c()</code> function can behave in unexpected ways with nested lists, and frequently will collapse the nesting into a single level, resulting in invalid EML.</p>
</div>
</div>
</section>
</section>
<section id="edit-attributelists" class="level2">
<h2 class="anchored" data-anchor-id="edit-attributelists">Edit attributeLists</h2>
<p>Attributes are descriptions of variables, typically columns or column names in tabular data. Attributes are stored in an <a href="https://eml.ecoinformatics.org/images/eml-attribute.png" target="_blank">attributeList</a>. When editing attributes in R, you need to create one to three objects:</p>
<ol type="1">
<li>A data.frame of attributes</li>
<li>A data.frame of custom units (if applicable)</li>
</ol>
<p>The <code>attributeList</code> is an element within one of 4 different types of entity objects. An entity corresponds to a file, typically. Multiple entities (files) can exist within a dataset. The 4 different entity types are <code>dataTable</code> (most common for us), <code>spatialVector</code>, <code>spatialRaster</code>, and <code>otherEntity</code></p>
<p>Please note that submitting attribute information through the website will store them in an <code>otherEntity</code> object by default. We prefer to store them in a <code>dataTable</code> object for tabular data or a <code>spatialVector</code> object for spatial data.</p>
<p>To edit or examine an existing attribute table already in an EML file, you can use the following commands, where <code>i</code> represents the index of the series element you are interested in. Note that if there is only one item in the series (ie there is only one <code>dataTable</code>), you should just call <code>doc$dataset$dataTable</code>, as in this case <code>doc$dataset$dataTable[[1]]</code> will return the first sub-element of the <code>dataTable</code> (the <code>entityName</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If they are stored in an otherEntity (submitted from the website by default)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>attributeList <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">get_attributes</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>otherEntity[[i]]<span class="sc">$</span>attributeList)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or if they are stored in a dataTable (usually created by a datateam member)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>attributeList <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">get_attributes</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Or if they are stored in a spatialVector (usually created by a datateam member)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>attributeList <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">get_attributes</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>spatialVector[[i]]<span class="sc">$</span>attributeList)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> attributeList<span class="sc">$</span>attributes</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(attributes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="edit-attributes" class="level3">
<h3 class="anchored" data-anchor-id="edit-attributes">Edit attributes</h3>
<p>Attribute information should be stored in a <code>data.frame</code> with the following columns:</p>
<ul>
<li><strong>attributeName</strong>: The name of the attribute as listed in the csv. Required. e.g.: “c_temp”</li>
<li><strong>attributeLabel</strong>: A descriptive label that can be used to display the name of an attribute. It is not constrained by system limitations on length or special characters. Optional. e.g.: “Temperature (Celsius)”</li>
<li><strong>attributeDefinition</strong>: Longer description of the attribute, including the required context for interpreting the <code>attributeName</code>. Required. e.g.: “The near shore water temperature in the upper inter-tidal zone, measured in degrees Celsius.”</li>
<li><strong>measurementScale</strong>: One of: nominal, ordinal, dateTime, ratio, interval. Required.
<ul>
<li><em>nominal</em>: unordered categories or text. e.g.: (Male, Female) or (Yukon River, Kuskokwim River)</li>
<li><em>ordinal</em>: ordered categories. e.g.: Low, Medium, High</li>
<li><em>dateTime</em>: date or time values from the Gregorian calendar. e.g.: 01-01-2001</li>
<li><em>ratio</em>: measurement scale with a meaningful zero point in nature. Ratios are proportional to the measured variable. e.g.: 0 Kelvin represents a complete absence of heat. 200 Kelvin is half as hot as 400 Kelvin. 1.2 meters per second is twice as fast as 0.6 meters per second.</li>
<li><em>interval</em>: values from a scale with equidistant points, where the zero point is arbitrary. This is usually reserved for degrees Celsius or Fahrenheit, or latitude and longitude coordinates, or any other human-constructed scale. e.g.: there is still heat at 0° Celsius; 12° Celsius is NOT half as hot as 24° Celsius.</li>
</ul></li>
<li><strong>domain</strong>: One of: <code>textDomain</code>, <code>enumeratedDomain</code>, <code>numericDomain</code>, <code>dateTime</code>. Required.
<ul>
<li><em>textDomain</em>: text that is free-form, or matches a pattern</li>
<li><em>enumeratedDomain</em>: text that belongs to a defined list of codes and definitions. e.g.: CASC = Cascade Lake, HEAR = Heart Lake</li>
<li><em>dateTimeDomain</em>: <code>dateTime</code> attributes</li>
<li><em>numericDomain</em>: attributes that are numbers (either <code>ratio</code> or <code>interval</code>)</li>
</ul></li>
<li><strong>formatString</strong>: Required for <code>dateTime</code>, NA otherwise. Format string for dates, e.g.&nbsp;“DD/MM/YYYY”.</li>
<li><strong>definition</strong>: Required for <code>textDomain</code>, NA otherwise. Definition for attributes that are a character string, matches attribute definition in most cases.</li>
<li><strong>unit</strong>: Required for <code>numericDomain</code>, NA otherwise. Unit string. If the unit is not a standard unit, a warning will appear when you create the attribute list, saying that it has been forced into a custom unit. Use caution here to make sure the unit really needs to be a custom unit. A list of standard units can be found using: <code>standardUnits &lt;- EML::get_unitList()</code> then running <code>View(standardUnits$units)</code>.</li>
<li><strong>numberType</strong>: Required for <code>numericDomain</code>, NA otherwise. Options are <code>real</code>, <code>natural</code>, <code>whole</code>, and <code>integer</code>.
<ul>
<li><em>real</em>: positive and negative fractions and integers (…-1,-0.25,0,0.25,1…)</li>
<li><em>natural</em>: non-zero positive integers (1,2,3…)</li>
<li><em>whole</em>: positive integers and zero (0,1,2,3…)</li>
<li><em>integer</em>: positive and negative integers and zero (…-2,-1,0,1,2…)</li>
</ul></li>
<li><strong>missingValueCode</strong>: Code for missing values (e.g.: ‘-999’, ‘NA’, ‘NaN’). NA otherwise. Note that an NA missing value code should be a string, ‘NA’, and numbers should also be strings, ‘-999.’</li>
<li><strong>missingValueCodeExplanation</strong>: Explanation for missing values, NA if no missing value code exists.</li>
</ul>
<p>You can create attributes manually by typing them out in R following a workflow similar to the one below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">attributeName =</span> <span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Location'</span>, <span class="st">'Region'</span>,<span class="st">'Sample_No'</span>, <span class="st">'Sample_vol'</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'Salinity'</span>, <span class="st">'Temperature'</span>, <span class="st">'sampling_comments'</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">attributeDefinition =</span> <span class="fu">c</span>(<span class="st">'Date sample was taken on'</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Location code representing location where sample was taken'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Region where sample was taken'</span>, <span class="st">'Sample number'</span>, <span class="st">'Sample volume'</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'Salinity of sample in PSU'</span>, <span class="st">'Temperature of sample'</span>, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'comments about sampling process'</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">measurementScale =</span> <span class="fu">c</span>(<span class="st">'dateTime'</span>, <span class="st">'nominal'</span>,<span class="st">'nominal'</span>, <span class="st">'nominal'</span>, <span class="st">'ratio'</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'ratio'</span>, <span class="st">'interval'</span>, <span class="st">'nominal'</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">domain =</span> <span class="fu">c</span>(<span class="st">'dateTimeDomain'</span>, <span class="st">'enumeratedDomain'</span>,<span class="st">'enumeratedDomain'</span>, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">'textDomain'</span>, <span class="st">'numericDomain'</span>, <span class="st">'numericDomain'</span>, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">'numericDomain'</span>, <span class="st">'textDomain'</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">formatString =</span> <span class="fu">c</span>(<span class="st">'MM-DD-YYYY'</span>, <span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">definition =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="st">'Sample number'</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'comments about sampling process'</span>),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">unit =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,<span class="st">'milliliter'</span>, <span class="st">'dimensionless'</span>, <span class="st">'celsius'</span>, <span class="cn">NA</span>),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">numberType =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,<span class="cn">NA</span>, <span class="st">'real'</span>, <span class="st">'real'</span>, <span class="st">'real'</span>, <span class="cn">NA</span>),</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">missingValueCode =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">'NA'</span>),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">missingValueCodeExplanation =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'no sampling comments'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, typing this out in R can be a major pain. Luckily, there’s a Shiny app that you can use to build attribute information. You can use the app to build attributes from a data file loaded into R (recommended as the app will auto-fill some fields for you) to edit an existing attribute table, or to create attributes from scratch. Use the following commands to create or modify attributes (these commands will launch a Shiny app in your web browser):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first download the CSV in your data package from Exercise #2</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_pid <span class="ot">&lt;-</span> <span class="fu">selectMember</span>(dp, <span class="at">name =</span> <span class="st">"sysmeta@fileName"</span>, <span class="at">value =</span> <span class="st">".csv"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text=</span><span class="fu">rawToChar</span>(<span class="fu">getObject</span>(d1c_test<span class="sc">@</span>mn, data_pid)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From data (recommended)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>EML<span class="sc">::</span><span class="fu">shiny_attributes</span>(<span class="at">data =</span> data)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># From an existing attribute table</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>attributeList <span class="ot">&lt;-</span> <span class="fu">get_attributes</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>EML<span class="sc">::</span><span class="fu">shiny_attributes</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">attributes =</span> attributeList<span class="sc">$</span>attributes)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># From scratch</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>atts <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">shiny_attributes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you are done editing a table in the app, quit the app and the tables will be assigned to the <code>atts</code> variable as a list of data frames (one for attributes, factors, and units). Alternatively, each table can be to exported to a csv file by clicking the <code>Download</code> button.</p>
<p>If you downloaded the table, read the table back into your R session and assign it to a variable in your script (e.g.&nbsp;<code>attributes &lt;- data.frame(...)</code>), or just use the variable that <code>shiny_attributes</code> returned.</p>
<p>For simple attribute corrections, <code>datamgmt::edit_attribute()</code> allows you to edit the slots of a single attribute within an attribute list. To use this function, pass an attribute through <code>datamgmt::edit_attribute()</code> and fill out the parameters you wish to edit/update. An example is provided below where we are changing <code>attributeName</code>, <code>domain</code>, and <code>measurementScale</code> in the first attribute of a dataset. After completing the edits, insert the new version of the attribute back into the EML document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>new_attribute <span class="ot">&lt;-</span> datamgmt<span class="sc">::</span><span class="fu">edit_attribute</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">1</span>]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[<span class="dv">1</span>]], </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">attributeName =</span> <span class="st">'date_and_time'</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">domain =</span> <span class="st">'dateTimeDomain'</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">measurementScale =</span> <span class="st">'dateTime'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">1</span>]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> new_attribute</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="edit-custom-units" class="level3">
<h3 class="anchored" data-anchor-id="edit-custom-units">Edit custom units</h3>
<p>EML has a set list of units that can be added to an EML file. These can be seen by using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>standardUnits <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">get_unitList</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(standardUnits<span class="sc">$</span>units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Search the units list for your unit before attempting to create a custom unit. You can search part of the unit you can look up part of the unit ie <code>meters</code> in the table to see if there are any matches.</p>
<p>If you have units that are not in the standard EML unit list, you will need to build a custom unit list. A unit typically consists of the following fields:</p>
<ul>
<li><strong>id</strong>: The <code>unit id</code> (ids are camelCased)</li>
<li><strong>unitType</strong>: The <code>unitType</code> (run <code>View(standardUnits$unitTypes)</code> to see standard <code>unitType</code>s)</li>
<li><strong>parentSI</strong>: The <code>parentSI</code> unit (e.g.&nbsp;for kilometer <code>parentSI</code> = “meter”)</li>
<li><strong>multiplierToSI</strong>: Multiplier to the <code>parentSI</code> unit (e.g.&nbsp;for kilometer <code>multiplierToSI</code> = 1000)</li>
<li><strong>name</strong>: Unit abbreviation (e.g.&nbsp;for kilometer <code>name</code> = “km”)</li>
<li><strong>description</strong>: Text defining the unit (e.g.&nbsp;for kilometer <code>description</code> = “1000 meters”)</li>
</ul>
<p>To manually generate the custom units list, create a dataframe with the fields mentioned above. An example is provided below that can be used as a template:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>custom_units <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(   </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="st">'siemensPerMeter'</span>, <span class="st">'decibar'</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">unitType =</span> <span class="fu">c</span>(<span class="st">'resistivity'</span>, <span class="st">'pressure'</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">parentSI =</span> <span class="fu">c</span>(<span class="st">'ohmMeter'</span>, <span class="st">'pascal'</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">multiplierToSI =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'10000'</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">abbreviation =</span> <span class="fu">c</span>(<span class="st">'S/m'</span>,<span class="st">'decibar'</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(<span class="st">'siemens per meter'</span>, <span class="st">'decibar'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>EML::get_unit_id</code> for custom units will also generate valid EML unit ids. Custom units are then added to <code>additionalMetadata</code> using the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>unitlist <span class="ot">&lt;-</span> <span class="fu">set_unitList</span>(custom_units, <span class="at">as_metadata =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>additionalMetadata <span class="ot">&lt;-</span>  <span class="fu">list</span>(<span class="at">metadata =</span> <span class="fu">list</span>(<span class="at">unitList =</span> unitlist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="edit-factors" class="level3">
<h3 class="anchored" data-anchor-id="edit-factors">Edit factors</h3>
<p>For attributes that are <code>enumeratedDomains</code>, a table is needed with three columns: <code>attributeName</code>, <code>code</code>, and <code>definition</code>.</p>
<ul>
<li><strong>attributeName</strong> should be the same as the <code>attributeName</code> within the attribute table and repeated for all codes belonging to a common attribute.</li>
<li><strong>code</strong> should contain all unique values of the given <code>attributeName</code> that exist within the actual data.</li>
<li><strong>definition</strong> should contain a plain text definition that describes each code.</li>
</ul>
<p>To build factors by hand, you use the named character vectors and then convert them to a data.frame as shown in the example below. In this example, there are two enumerated domains in the attribute list - “Location” and “Region”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Location <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">CASC =</span> <span class="st">'Cascade Lake'</span>, <span class="at">CHIK =</span> <span class="st">'Chikumunik Lake'</span>, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">HEAR =</span> <span class="st">'Heart Lake'</span>, <span class="at">NISH =</span> <span class="st">'Nishlik Lake'</span> )</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Region <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">W_MTN =</span> <span class="st">'West region, locations West of Eagle Mountain'</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">E_MTN =</span> <span class="st">'East region, locations East of Eagle Mountain'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The definitions are then written into a data.frame using the names of the named character vectors and their definitions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>factors <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">attributeName =</span> <span class="st">'Location'</span>, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">code =</span> <span class="fu">names</span>(Location), </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">definition =</span> <span class="fu">unname</span>(Location)),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(<span class="at">attributeName =</span> <span class="st">'Region'</span>, <span class="at">code =</span> <span class="fu">names</span>(Region), </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">definition =</span> <span class="fu">unname</span>(Region)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="finalize-attributelist" class="level3">
<h3 class="anchored" data-anchor-id="finalize-attributelist">Finalize attributeList</h3>
<p>Once you have built your attributes, factors, and custom units, you can add them to EML objects. Attributes and factors are combined to form an <code>attributeList</code> using the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>attributeList <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">set_attributes</span>(<span class="at">attributes =</span> attributes,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">factors =</span> factors) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This <code>attributeList</code> must then be <a href="#edit-datatables">added to a <code>dataTable</code></a>.</p>
</section>
</section>
<section id="edit-custom-units-1" class="level2">
<h2 class="anchored" data-anchor-id="edit-custom-units-1">Edit custom units</h2>
<p>EML has a set list of units that can be added to an EML file. These can be seen by using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>standardUnits <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">get_unitList</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(standardUnits<span class="sc">$</span>units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you have units that are not in the standard EML unit list, you will need to build a custom unit list. A unit typically consists of the following fields:</p>
<ul>
<li><strong>id</strong>: The <code>unit id</code> (ids are camelCased)</li>
<li><strong>unitType</strong>: The <code>unitType</code> (run <code>View(standardUnits$unitTypes)</code> to see standard <code>unitType</code>s)</li>
<li><strong>parentSI</strong>: The <code>parentSI</code> unit (e.g.&nbsp;for kilometer <code>parentSI</code> = “meter”)</li>
<li><strong>multiplierToSI</strong>: Multiplier to the <code>parentSI</code> unit (e.g.&nbsp;for kilometer <code>multiplierToSI</code> = 1000)</li>
<li><strong>name</strong>: Unit abbreviation (e.g.&nbsp;for kilometer <code>name</code> = “km”)</li>
<li><strong>description</strong>: Text defining the unit (e.g.&nbsp;for kilometer <code>description</code> = “1000 meters”)</li>
</ul>
<p>To manually generate the custom units list, create a dataframe with the fields mentioned above. An example is provided below that can be used as a template:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>custom_units <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="st">'partsPerThousand'</span>, <span class="st">'decibar'</span>, <span class="st">'wattsPerSquareMeter'</span>, <span class="st">'micromolesPerGram'</span>, <span class="st">'practicalSalinityUnit'</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">unitType =</span> <span class="fu">c</span>(<span class="st">'dimensionless'</span>, <span class="st">'pressure'</span>, <span class="st">'power'</span>, <span class="st">'amountOfSubstanceWeight'</span>， <span class="st">'dimensionless'</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">parentSI =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">'pascal'</span>, <span class="st">'watt'</span>, <span class="st">'molesPerKilogram'</span>， <span class="cn">NA</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">multiplierToSI =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">'10000'</span>, <span class="st">'1'</span>, <span class="st">'1000000000'</span>, <span class="cn">NA</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">abbreviation =</span> <span class="fu">c</span>(<span class="st">'ppt'</span>, <span class="st">'decibar'</span>, <span class="st">'W/m^2'</span>, <span class="st">'umol/g'</span>, <span class="st">'PSU'</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(<span class="st">'parts per thousand'</span>, <span class="st">'decibar'</span>, <span class="st">'watts per square meter'</span>, <span class="st">'micro moles per gram'</span>, <span class="st">'used to describe the concentration of dissolved salts in water, the UNESCO Practical Salinity Scale of 1978 (PSS78) defines salinity in terms of a conductivity ratio'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>EML::get_unit_id</code> for custom units will also generate valid EML unit ids.</p>
<p>Custom units are then added to <code>additionalMetadata</code> using the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>unitlist <span class="ot">&lt;-</span> <span class="fu">set_unitList</span>(custom_units, <span class="at">as_metadata =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>additionalMetadata <span class="ot">&lt;-</span> unitlist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If units that should be <code>standardUnit</code> are added as <code>customUnit</code>, you can use the following code to fix this issue: ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add standard unit</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[i]]<span class="sc">$</span>measurementScale<span class="sc">$</span>ratio<span class="sc">$</span>unit<span class="sc">$</span>standardUnit <span class="ot">&lt;-</span> <span class="st">"your standard unit"</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of custom unit</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[i]]<span class="sc">$</span>measurementScale<span class="sc">$</span>ratio<span class="sc">$</span>unit<span class="sc">$</span>customUnit <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>If you want to find all of the positions of a certain custom unit that should be standard, try this code: ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">~</span><span class="fu">str_detect</span>(.x<span class="sc">$</span>measurementScale<span class="sc">$</span>ratio<span class="sc">$</span>unit<span class="sc">$</span>customUnit, <span class="st">"your standard unit"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(ls <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
</section>
<section id="edit-datatables" class="level2">
<h2 class="anchored" data-anchor-id="edit-datatables">Edit dataTables</h2>
<p>To edit a <code>dataTable</code>, first <a href="#edit-attributelists">edit/create an <code>attributeList</code></a> and <a href="#set-physical">set the physical</a>. Then create a new <code>dataTable</code> using the <code>eml$dataTable()</code> helper function as below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dataTable <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">dataTable</span>(<span class="at">entityName =</span> <span class="st">"A descriptive name for the data (does not need to be the same as the data file)"</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">entityDescription =</span> <span class="st">"A description of the data"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">physical =</span> physical,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">attributeList =</span> attributeList)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>dataTable</code> must then be added to the EML. How exactly you do this will depend on whether there are <code>dataTable</code> elements in your EML, and how many there are. To replace whatever dataTable elements already exist, you could write:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable <span class="ot">&lt;-</span> dataTable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If there is only one <code>dataTable</code> in your dataset, the EML package will usually “unpack” these, so that it is not contained within a list of length 1 - this means that to add a second <code>dataTable</code>, you cannot use the syntax <code>doc$dataset$dataTable[[2]]</code>, since when unpacked this will contain the <code>entityDescription</code> as opposed to pointing to the second in a series of <code>dataTable</code> elements. Confusing - I know. Not to fear though - this syntax will get you on your way, should you be trying to add a second <code>dataTable</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable <span class="ot">&lt;-</span> <span class="fu">list</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable, dataTable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If there is more than one <code>dataTable</code> in your dataset, you can return to the more straightforward construction of:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]] <span class="ot">&lt;-</span> dataTable </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where <code>i</code> is the index that you wish insert your <code>dataTable</code> into.</p>
<p>To add a list of <code>dataTables</code> to avoid the unpacking problem above you will need to create a list of <code>dataTables</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dts <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># create an empty list</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(tables_you_need)){</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># your code modifying/creating the dataTable here</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  dataTable <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">dataTable</span>(<span class="at">entityName =</span> dataTable<span class="sc">$</span>entityName,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">entityDescription =</span> dataTable<span class="sc">$</span>entityDescription,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">physical =</span> physical,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">attributeList =</span> attributeList)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  dts[[i]] <span class="ot">&lt;-</span> dataTable <span class="co"># add to the list</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After getting a list of <code>dataTables</code>, assign the resulting list to <code>dataTable</code> EML.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable <span class="ot">&lt;-</span> dts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, the online submission form adds all entities as <code>otherEntity</code>, even when most should probably be <code>dataTable</code>. You can use <code>eml_otherEntity_to_dataTable</code> to easily move items in <code>otherEntity</code> over to <code>dataTable</code>. Most tabular data or data that contain variables should be listed as a <code>dataTable</code>. Data that do not contain variables (eg: plain text readme files, pdfs, jpegs) should be listed as <code>otherEntity</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eml_otherEntity_to_dataTable</span>(doc, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">1</span>, <span class="co"># which otherEntities you want to convert, for multiple use - 1:5</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">validate_eml =</span> F) <span class="co"># set this to False if the physical or attributes are not added</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="semantic-annotations" class="level2">
<h2 class="anchored" data-anchor-id="semantic-annotations">Semantic annotations</h2>
<p>For a brief overview of what a semantic annotation is, and why we use them check out <a href="https://drive.google.com/file/d/1Err-fL8O21kd1NzHJ9HJkK_B2fpt4sQW/view?usp=sharing">this video.</a></p>
<p>Even more information on how to add semantic annotations to EML 2.2.0 can be found <a href="https://eml.ecoinformatics.org/semantic-annotation-primer.html">here</a>. Currently metacatUI does not support the editing of semantic annotations on the website so all changes will have to be done in R.</p>
<p>There are several elements in the EML 2.2.0 schema that can be annotated:</p>
<ul>
<li><code>dataset</code></li>
<li>entity (eg: <code>otherEntity</code> or <code>dataTable</code>)</li>
<li><code>attribute</code></li>
</ul>
<p>On the datateam, we will only be adding annotations to attributes for now.</p>
<section id="how-annotations-are-used" class="level3">
<h3 class="anchored" data-anchor-id="how-annotations-are-used">How annotations are used</h3>
<p>This is a <a href="https://arcticdata.io/catalog/view/doi%3A10.18739%2FA2KW57J9Q">dataset</a> that has semantic annotations included.</p>
<p>On the website you can see annotations in each of the attributes.</p>
<p><img src="../../images/annotations_web.png" class="img-fluid"></p>
<p><img src="../../images/annotations_web.png" class="img-fluid"></p>
<p>You can click on any one of them to search for more datasets with that same annotation.</p>
<p><img src="../../images/annotations_web_use.png" class="img-fluid"></p>
<section id="attribute-level-annotations" class="level4">
<h4 class="anchored" data-anchor-id="attribute-level-annotations">Attribute-level annotations</h4>
<p>To add annotations to the <code>attributeList</code> you will need information about the <code>propertyURI</code> and <code>valueURI</code></p>
<p>Annotations are essentially composed of a sentence, which contains a subject (the attribute), predicate (<code>propertyURI</code>), and object (<code>valueURI</code>). Because of the way our search interface is built, for now we will be using attribute annotations that have a <code>propertyURI</code> label of “contains measurements of type”.</p>
<p>Here is what an annotation for an attribute looks like in R. Note that both the <code>propertyURI</code> and <code>valueURI</code> have both a label, and the URI itself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[i]]<span class="sc">$</span>annotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>$id
[1] "ODBcOyaTsg"

$propertyURI
$propertyURI$label
[1] "contains measurements of type"

$propertyURI$propertyURI
[1] "http://ecoinformatics.org/oboe/oboe.1.2/oboe-core.owl#containsMeasurementsOfType"


$valueURI
$valueURI$label
[1] "Distributed Biological Observatory region identifier"

$valueURI$valueURI
[1] "http://purl.dataone.org/odo/ECSO_00002617"</code></pre>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Semantic attribute annotations can be applied to spatialRasters, spatialVectors and dataTables</p>
</div>
</div>
</section>
</section>
<section id="how-to-add-an-annotation" class="level3">
<h3 class="anchored" data-anchor-id="how-to-add-an-annotation">How to add an annotation</h3>
<p><strong>1. Decide which variable to annotate</strong></p>
<p>The goal for the datateam is to start annotating every dataset that comes in. Please make sure to add semantic annotations to spatial and temporal features such as latitude, longitude, site name and date and aim to annotate as many attributes as possible.</p>
<p><strong>2. Find an appropriate <code>valueURI</code></strong></p>
<p>The next step is to find an appropriate value to fill in the blank of the sentence: “this attribute contains measurements of _____.”</p>
<p>There are several ontologies to search in. In order of most to least likely to be relevant to the Arctic Data Center they are:</p>
<ul>
<li><a href="http://bioportal.bioontology.org/ontologies/ECSO/?p=classes&amp;conceptid=http://purl.dataone.org/odo/ECSO_00002925">The Ecosystem Ontology (ECSO)</a>
<ul>
<li>this was developed at NCEAS, and has many terms that are relevant to ecosystem processes, especially those involving carbon and nutrient cycling</li>
</ul></li>
<li><a href="http://bioportal.bioontology.org/ontologies/ENVO/?p=classes&amp;conceptid=root">The Environment Ontology (EnVO)</a>
<ul>
<li>this is an ontology for the concise, controlled description of environments</li>
</ul></li>
<li><a href="http://bioportal.bioontology.org/ontologies/NCBITAXON/?p=classes&amp;conceptid=root">National Center for Biotechnology Information (NCBI) Organismal Classification (NCBITAXON)</a>
<ul>
<li>The NCBI Taxonomy Database is a curated classification and nomenclature for all of the organisms in the public sequence databases.</li>
</ul></li>
<li><a href="http://bioportal.bioontology.org/ontologies/IAO/?p=summary">Information Artifact Ontology (IAO)</a>
<ul>
<li>this ontology contains terms related to information entities (eg: journals, articles, datasets, identifiers)</li>
</ul></li>
</ul>
<p>To search, navigate through the “classes” until you find an appropriate term. When we are picking terms, it is important that we not just pick a similar term or a term that seems close - we want a term that is totally “right”. For example, if you have an attribute for carbon tetroxide flux and an ontology with a class hierarchy like this:</p>
<p>– carbon flux<br>
|—- carbon dioxide flux</p>
<p>Our exact attribute, carbon tetroxide flux is not listed. In this case, we should pick “carbon flux” as it’s completely correct and not “carbon dioxide flux” because it’s more specific but not quite right.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For general attributes (such as ones named depth or length), it is important to be as specific as possible about what is being measured.</p>
<p>e.g.&nbsp;selecting the lake area annotation for the <a href="https://arcticdata.io/catalog/view/urn%3Auuid%3A64a3a75b-0630-44d2-a7e7-519029a48d9d#urn%3Auuid%3Ab8c29251-e628-405a-8e66-a5fa55703904">area attribute</a> in this dataset</p>
</div>
</div>
<p><strong>3. Build the annotation in R</strong></p>
<section id="manually-annotating" class="level4">
<h4 class="anchored" data-anchor-id="manually-annotating">Manually Annotating</h4>
<p><em>this method is great for when you are inserting 1 annotation, fixing an existing annotation or programmatically updating annotations for multiple attributeLists</em></p>
<p>First you need to figure out the index of the attribute you want to annotate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eml_get_simple</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">3</span>]]<span class="sc">$</span>attributeList, <span class="st">"attributeName"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code> [1] "prdM"         "t090C"        "t190C"        "c0mS/cm"      "c1mS/cm"      "sal00"        "sal11"        "sbeox0V"      "flECO-AFL"
[10] "CStarTr0"     "cpar"         "v0"           "v4"           "v6"           "v7"           "svCM"         "altM"         "depSM"    
[19] "scan"         "sbeox0ML/L"   "sbeox0dOV/dT" "flag"    </code></pre>
<p>Next, assign an <code>id</code> to the attribute. It should be unique within the document, and it’s nice if it is human readable and related to the attribute it is describing. One format you could use is <code>entity_x_attribute_y</code> which should be unique in scope, and is nice and descriptive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">3</span>]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[<span class="dv">6</span>]]<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="st">"entity_ctd_attribute_salinity"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, assign the <code>propertyURI</code> information. This will be the same for every annotation you build.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">3</span>]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[<span class="dv">6</span>]]<span class="sc">$</span>annotation<span class="sc">$</span>propertyURI <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"contains measurements of type"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                                                                       <span class="at">propertyURI =</span> <span class="st">"http://ecoinformatics.org/oboe/oboe.1.2/oboe-core.owl#containsMeasurementsOfType"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, add the <code>valueURI</code> information from your search.</p>
<p><img src="../images/bioportal_term.png" class="img-fluid"> You should see an ID on the Bioportal page that looks like a URL - this is the <code>valueURI</code>. Use the value to populate the label element.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">3</span>]]<span class="sc">$</span>attributeList<span class="sc">$</span>attribute[[<span class="dv">6</span>]]<span class="sc">$</span>annotation<span class="sc">$</span>valueURI <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Water Salinity"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">valueURI =</span> <span class="st">"http://purl.dataone.org/odo/ECSO_00001164"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="shiny-attributes" class="level4">
<h4 class="anchored" data-anchor-id="shiny-attributes">Shiny Attributes</h4>
<p><em>this method is great for when you are updating many attributes</em></p>
<p>On the far right of the table of <code>shiny_attributes</code> there are 4 columns: <code>id</code>, <code>propertyURI</code>, <code>propertyLabel</code>, <code>valueURI</code>, <code>valueLabel</code> that can be filled out.</p>
</section>
</section>
<section id="annotating-sensitive-data" class="level3">
<h3 class="anchored" data-anchor-id="annotating-sensitive-data">Annotating sensitive data</h3>
<p>Sensitive datasets that might cover protected characteristics (human subjects data, endangered species locations, etc) should be annotated using the data sensitivity ontology: https://bioportal.bioontology.org/ontologies/SENSO/?p=classes&amp;conceptid=root.</p>
<section id="dataset-annotations" class="level4">
<h4 class="anchored" data-anchor-id="dataset-annotations">Dataset Annotations</h4>
<p>As a final step in the data processing pipeline, we will categorize the dataset. We are trying to categorize datasets so we can have a general idea of what kinds of data we have at the Arctic Data Center.</p>
<p>Datasets will be categorized using the <a href="https://bioportal.bioontology.org/ontologies/ADCAD/?p=classes&amp;conceptid=root">Academic Ontology</a>. These annotations will be seen at the top of the landing page, and can be thought of as “themes” for the dataset. In reality, they are dataset-level annotations.</p>
<p>Be sure to ask your peers in the #datateam slack channel whether they agree with the themes you think best fit your dataset. Once there is consensus, use the following line of code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>doc <span class="ot">&lt;-</span> datamgmt<span class="sc">::</span><span class="fu">eml_categorize_dataset</span>(doc, <span class="fu">c</span>(<span class="st">"list"</span>, <span class="st">"of"</span>, <span class="st">"themes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="edit-spatial-data" class="level2">
<h2 class="anchored" data-anchor-id="edit-spatial-data">Edit spatial data</h2>
<p>Occasionally, you may encounter a third type of data object: <code>spatialVector</code> and <code>spatialRaster</code>. These objects contains spatial data (ie maps), such as a shapefile or geodatabase.</p>
<p>Editing a <code>spatialVector</code> or <code>spatialRaster</code> is similar to editing a <code>dataTable</code> or an <code>otherEntity</code>. A <code>physical</code> and <code>attributeList</code> should be present. We will focus on how to get the information unique to spatialData and how to create the <code>spatialVector/spatialRaster</code></p>
<section id="file-types" class="level4">
<h4 class="anchored" data-anchor-id="file-types">File types</h4>
<p>File extensions to look for that might be spatial data: kml, geoJSON, geoTIFF, .dbf, .shp, and .shx</p>
<p>Additionally, spatial data that involve multiple files should typically be archived within a .zip file to ensure all related and interdependent files stay together (ie . a geodatabase). This is one of the exceptions to our rule regarding .zip files.</p>
<p>For example, a spatial dataset for a shapefile should, at a minimum, consist of separate .dbf, .shp, and .shx files with the same prefix in the same directory. All these files are required in order to use the data. Also note that shapefiles limit attribute names to 10 characters, so attribute names in the metadata may not match exactly to attribute names in the data. Some spatial raster data come as standalone files (.tiff or .nc) and some come as a group of files. If you aren’t sure whether to unzip a file, ask Jasmine or Jeanette.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are specific <code>formatIds</code> for these kinds of zipped files: <code>application/vnd.shp+zip</code> <code>image/geotiff+zip</code>. Remember to check that the files have the correct <code>formatId</code></p>
</div>
</div>
</section>
<section id="reading-spatial-files" class="level3">
<h3 class="anchored" data-anchor-id="reading-spatial-files">Reading Spatial Files</h3>
<p>Read in the files to (1) help you in creating your attributes table and (2) sometimes also figure out the coordinate reference system.</p>
<pre><code>library(sf)
spatial_file &lt;- sf::read_sf("example.kml")</code></pre>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you read kml files, <code>read_sf()</code> sometimes shows additional columns that aren’t in the actual file. Always open kml files in text editor to check if the columns actually exist.</p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If it is a zipped shapefile there is a handy function you can use <code>arcticdatautils::read_zip_shapefile(mn, pid)</code></p>
</div>
</div>
<section id="coordinate-systems" class="level4">
<h4 class="anchored" data-anchor-id="coordinate-systems">Coordinate Systems</h4>
<p>The coordinate system allow to work with spatial data using the same frame of reference (a Datum). A common coordinate system is “<code>GCS_WGS_1984</code> (used in Google Maps!) which is suitable for plotting points distributed globally. There are many others that may be better suited for certain areas in the world.</p>
<p>All latitudes and longitude coordinates should have a coordinate system (like a frame of reference).</p>
<p>There are horizontal coordinate systems (earth’s surface) and vertical coordinate systems (depth). More information can be found <a href="https://pro.arcgis.com/en/pro-app/help/mapping/properties/coordinate-systems-and-projections.htm" target="_blank">here</a>.</p>
<p>To find the <code>horizCoordSysName</code> you can use:</p>
<pre><code>sf::st_crs(spatial_file)</code></pre>
<p>Take the Datum and add GCS (Geographic Coordinate System) in front. For example: “GCS_WGS_1984”</p>
</section>
</section>
<section id="spatialvector" class="level3">
<h3 class="anchored" data-anchor-id="spatialvector">spatialVector</h3>
<section id="adding-geometry" class="level4">
<h4 class="anchored" data-anchor-id="adding-geometry">Adding Geometry</h4>
<p>One important difference is that a <code>spatialVector</code> object should also have a <code>geometry</code> slot that describes the geometry features of the data. The possible values include one or more (in a list) of ‘Point’, ‘LineString’, ‘LinearRing’, ‘Polygon’, ‘MultiPoint’, ‘MultiLineString’, ‘MultiPolygon’, or ‘MultiGeometry’. You will likely have to open the file itself within QGIS or R (ie . the <code>sf</code> package) to get the correct geometry value.</p>
<p>To add just a <code>geometry</code> slot use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>spatialVector[[<span class="dv">1</span>]]<span class="sc">$</span>geometry <span class="ot">&lt;-</span> <span class="st">"Polygon"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To add it using the data pid: 1. Get the geometry and spatialReference 2. Use <code>pid_to_eml_entity()</code> to generate the spatialVector</p>
<pre><code> spatialVector &lt;- pid_to_eml_entity(adc, 
                                    pkg$data[n], 
                                    entity_type = "spatialVector",
                                    entityName = "filename.kml",
                                    entityDescription = "some desciption",
                                    attributeList = attributeList,
                                    geometry = "Point",
                                    spatialReference = list(horizCoordSysName = "GCS_WGS_1984"))</code></pre>
<ol start="3" type="1">
<li>Add the spatialVector to the <code>doc</code></li>
</ol>
<pre><code>doc$dataset$spatialVector[[1]] &lt;- spatialVector</code></pre>
</section>
</section>
<section id="spatialrasters" class="level3">
<h3 class="anchored" data-anchor-id="spatialrasters">spatialRasters</h3>
<p>Most often these come in GeoTiff or Tiff files. The data is presented as a grid of “pixels”. For more information ESRI has a indepth article <a href="https://desktop.arcgis.com/en/arcmap/10.3/manage-data/raster-and-images/what-is-raster-data.htm" target="_blank">here</a>.</p>
<p>To use the helper function get:</p>
<ol type="1">
<li>the path of your raster file</li>
<li>an attribute table</li>
<li>a coordinate system</li>
</ol>
<p>To get a coordinate system name, you can use the output of the function on your first try (which will print the coordinate reference system, if it is defined). You can use the return value of <code>get_coord_list()</code> (a large <code>data.frame</code>) to find the correct coordinate system name.</p>
<p>Another way to get the coordinate system name is using <code>rgdal::GDALinfo(path)</code>. This function can provide many details for your GeoTiff or Tiff files including the coordinate system name. More information can be found here <a href="https://www.earthdatascience.org/courses/earth-analytics/lidar-raster-data-r/introduction-to-spatial-metadata-r/" target="_blank">here</a>.</p>
<pre><code>rgdal::GDALinfo(path)

eml_get_raster_metadata(path, coord_name, attributes)</code></pre>
</section>
</section>
<section id="format-text-in-eml" class="level2">
<h2 class="anchored" data-anchor-id="format-text-in-eml">Format text in EML</h2>
<p>Currently, only certain fields (abstracts, methods) support text formatting in EML. Check out this <a href="https://github.nceas.ucsb.edu/KNB/arctic-data/blob/ac4cabed2ee9ff3654130ee162266174fafa003a/datateam/How_To/EML/EMl_textType_example.xml" target="_blank">demo</a> for a full example. Additional info is also available <a href="https://knb.ecoinformatics.org/#external//emlparser/docs/eml-2.1.1/./eml-text.html" target="_blank">here</a>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many of these formatting functions only work when enclosed by <code>&lt;para&gt;&lt;/para&gt;</code></p>
</div>
</div>
<p>You can insert these tags directly into the EML document using syntax that looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>abstract <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">abstract</span>(<span class="at">para =</span> <span class="st">"Some abstracts require subscripts like CO&lt;subscript&gt;2&lt;/subscript&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="type-setting" class="level3">
<h3 class="anchored" data-anchor-id="type-setting">Type-setting</h3>
<p>Subscripts, superscripts, and italics:</p>
<pre><code>&lt;subscript&gt;You can do subscripts&lt;/subscript&gt;
&lt;superscript&gt;or superscipts&lt;/superscript&gt;
&lt;emphasis&gt;or even italics.&lt;/emphasis&gt; </code></pre>
</section>
<section id="links" class="level3">
<h3 class="anchored" data-anchor-id="links">Links</h3>
<p>Be sure to include the “https://” before the link or it will redirect incorrectly. Also, always check that your links go through to the correct page. Please be aware that most links are inherently unstable so always default to archiving files over pointing to websites when possible and appropriate.</p>
<pre><code>&lt;ulink url="https://some_url.com"&gt;
    &lt;citetitle&gt;some text&lt;/citetitle&gt;
&lt;/ulink&gt;</code></pre>
</section>
<section id="lists" class="level3">
<h3 class="anchored" data-anchor-id="lists">Lists</h3>
<p>Unordered (bulleted) lists:</p>
<pre><code>&lt;itemizedlist&gt;
    &lt;listitem&gt;
        &lt;para&gt;Paragraphs&lt;/para&gt;
    &lt;/listitem&gt;
    &lt;listitem&gt;
        &lt;para&gt;Sections w/ subsections (w/ titles)&lt;/para&gt;
    &lt;/listitem&gt;
&lt;/itemizedlist&gt;</code></pre>
<p>Ordered lists (1, 2, 3)…</p>
<pre><code>&lt;orderedlist&gt;
    &lt;listitem&gt;
        &lt;para&gt;something&lt;/para&gt;
    &lt;/listitem&gt;
    &lt;listitem&gt;
        &lt;para&gt;something else&lt;/para&gt;
    &lt;/listitem&gt;
&lt;/orderedlist&gt;</code></pre>
</section>
</section>
<section id="series-identifier-sid" class="level2">
<h2 class="anchored" data-anchor-id="series-identifier-sid">Series Identifier (SID)</h2>
<p>A series identifier is a system metadata field that represents a single identifier across multiple versions of a data package, a feature often requested by submitters. These are useful for maintaining a single identifier when a data package is expected to receive updates (usually additional data) in the future. For example, this dataset has a series id: https://doi.org/10.18739/A2154DQ22 (the doi and urn:uuid are both present at the top of the dataset).</p>
<section id="adding-a-sid-to-a-package" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-sid-to-a-package">Adding a SID to a package</h3>
<p>Adding a series identifier should be the last step. In most cases the SID will be in <code>DOI</code> format. Once the data package is complete (peer-reviewd and approved by the PI) the series identifier can be added by updating the <code>seriesId</code> field of the system metadata of the metadata object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The metadata identifier we're assigning an SID to</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>metadata_pid <span class="ot">&lt;-</span> <span class="st">'metadata_pid'</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>sys <span class="ot">&lt;-</span> <span class="fu">getSystemMetadata</span>(mn, metadata_pid)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>sys<span class="sc">@</span>seriesId <span class="ot">&lt;-</span> <span class="fu">generateIdentifier</span>(mn, <span class="at">scheme =</span> <span class="st">'DOI'</span>) <span class="co">#update the scheme argument if it should not be a DOI</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">updateSystemMetadata</span>(mn, metadata_pid, sys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="updating-the-child-packages-of-a-parent-package-with-a-sid" class="level3">
<h3 class="anchored" data-anchor-id="updating-the-child-packages-of-a-parent-package-with-a-sid">Updating the child packages of a parent package with a SID</h3>
<p>When updating a parent package with a series identifier you need to use <code>update_resource_map</code> rather than <code>publish_update</code>. In this case our goal is add nested data packages to an existing parent package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call get_package on the parent package that has a `seriesId` in its system metadata </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>parent_package <span class="ot">&lt;-</span> <span class="fu">get_package</span>(mn, <span class="st">'resource_map_pid'</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The resource map of the package we want to add to the 'child_pids' of the parent</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>resource_map_new_child <span class="ot">&lt;-</span> <span class="st">''</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">update_resource_map</span>(mn, parent_package<span class="sc">$</span>resource_map, parent_package<span class="sc">$</span>metadata, parent_package<span class="sc">$</span>data,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(parent_package<span class="sc">$</span>child_packages, resource_map_new_child))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="updating-the-metadata-of-a-package-with-a-sid" class="level3">
<h3 class="anchored" data-anchor-id="updating-the-metadata-of-a-package-with-a-sid">Updating the metadata of a package with a SID</h3>
<p>When updating the metadata (xml) of a package with a series identifier use <code>publish_update</code>. It’s important that you pass the metadata pid to the <code>metadata_pid</code> argument rather than <code>seriesId</code>. The metadata pid will usually have the text “version:” ahead of it, however it’s best to use <code>get_package</code> first to avoid mistakes. ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>pkg <span class="ot">&lt;-</span> <span class="fu">get_package</span>(mn, <span class="st">'resource_map_pid'</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>pkg <span class="ot">&lt;-</span> <span class="fu">publish_update</span>(mn, pkg<span class="sc">$</span>metadata, pkg<span class="sc">$</span>resource_map, pkg<span class="sc">$</span>data, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">child_pids =</span> pkg<span class="sc">$</span>child_pids) <span class="co"># + any additional arguments to "publish_update"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
</section>
</section>
<section id="set-coverages" class="level2">
<h2 class="anchored" data-anchor-id="set-coverages">Set coverages</h2>
<p>Sometimes EML documents may lack coverage information describing the temporal, geographic, or taxonomic coverage of a data set. This example shows how to create coverage information from scratch, or replace an existing coverage element with an updated one. You can view the current coverage (if it exists) by entering <code>doc$dataset$coverage</code> into the console. Here the coverage, including temporal, taxonomic, and geographic coverages, is defined using <code>set_coverage()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">set_coverage</span>(<span class="at">beginDate =</span> <span class="st">'2012-01-01'</span>, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">endDate =</span> <span class="st">'2012-01-10'</span>, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sci_names =</span> <span class="fu">c</span>(<span class="st">'exampleGenus exampleSpecies1'</span>, <span class="st">'exampleGenus ExampleSpecies2'</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">geographicDescription =</span> <span class="st">"The geographic region covers the lake region near Eagle Mountain, Alaska."</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">west =</span> <span class="sc">-</span><span class="fl">154.6192</span>, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">east =</span> <span class="sc">-</span><span class="fl">154.5753</span>, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">north =</span> <span class="fl">68.3831</span>, </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">south =</span> <span class="fl">68.3619</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>coverage <span class="ot">&lt;-</span> coverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="set-multiple-coverages" class="level3">
<h3 class="anchored" data-anchor-id="set-multiple-coverages">Set multiple coverages</h3>
<p>You can also set multiple geographic (or temporal) coverages. Here is an example of how you might set two geographic coverages. Note that we use nested <code>eml</code> function helpers in this construction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>geocov1 <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">geographicCoverage</span>(<span class="at">geographicDescription =</span> <span class="st">"The geographich region covers area 1"</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">boundingCoordinates =</span> eml<span class="sc">$</span><span class="fu">boundingCoordinates</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">northBoundingCoordinate =</span> <span class="dv">68</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">eastBoundingCoordinate =</span> <span class="sc">-</span><span class="dv">154</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">southBoundingCoordinate =</span> <span class="dv">67</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">westBoundingCoordinate =</span> <span class="sc">-</span><span class="dv">155</span>))</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>geocov2 <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">geographicCoverage</span>(<span class="at">geographicDescription =</span> <span class="st">"The geographich region covers area 2"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">boundingCoordinates =</span> eml<span class="sc">$</span><span class="fu">boundingCoordinates</span>(</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">northBoundingCoordinate =</span> <span class="dv">65</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">eastBoundingCoordinate =</span> <span class="sc">-</span><span class="dv">151</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">southBoundingCoordinate =</span> <span class="dv">62</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">westBoundingCoordinate =</span> <span class="sc">-</span><span class="dv">153</span>))</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">set_coverage</span>(<span class="at">beginDate =</span> <span class="st">'2012-01-01'</span>, </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">endDate =</span> <span class="st">'2012-01-10'</span>, </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sci_names =</span> <span class="fu">list</span>(<span class="st">'exampleGenus exampleSpecies1'</span>, <span class="st">'exampleGenus ExampleSpecies2'</span>))</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>coverage<span class="sc">$</span>geographicCoverage <span class="ot">&lt;-</span> <span class="fu">list</span>(geocov1, geocov2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="special-coverages" class="level3">
<h3 class="anchored" data-anchor-id="special-coverages">Special coverages</h3>
<section id="arctic-circle" class="level4">
<h4 class="anchored" data-anchor-id="arctic-circle">Arctic Circle</h4>
<p>For arctic circle geographic coverage, we only have the starting vertical line of the circle shown in the projection. <a href="https://arcticdata.io/catalog/view/doi%3A10.18739%2FA2QJ77Z7P" target="_blank">Here</a> is an example with arctic circle geographic coverage.</p>
</section>
<section id="geologic-dates" class="level4">
<h4 class="anchored" data-anchor-id="geologic-dates">Geologic dates</h4>
<p><a href="https://arcticdata.io/catalog/view/doi%3A10.18739%2FA2D795B3Q" target="_blank">Example dataset</a> with geologic coverages set using the following: ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>geo_time_start <span class="ot">&lt;-</span> EML<span class="sc">::</span>eml<span class="sc">$</span><span class="fu">alternativeTimeScale</span>(<span class="at">timeScaleName =</span> <span class="st">"Absolute"</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">timeScaleAgeEstimate =</span> <span class="st">"7.5 Myr"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> EML<span class="sc">::</span><span class="fu">set_coverage</span>(<span class="at">beginDate =</span> <span class="st">'2012-01-01'</span>, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">endDate =</span> <span class="st">'2012-01-10'</span>, </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>coverage <span class="ot">&lt;-</span> coverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
</section>
</section>
</section>
<section id="set-methods" class="level2">
<h2 class="anchored" data-anchor-id="set-methods">Set methods</h2>
<p>The methods tree in the EML section has many different options, visible in the <a href="https://eml.ecoinformatics.org/schema/index.html" target="_blank">schema</a>. You can create new elements in the methods tree by following the schema and using the <code>eml</code> helpers.</p>
<p>Another simple and potentially useful way to add methods to an EML that has no methods at all is by adding them via a MS Word document. An example is shown below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>methods1 <span class="ot">&lt;-</span> <span class="fu">set_methods</span>(<span class="st">'methods_doc.docx'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>methods <span class="ot">&lt;-</span> methods1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you want to make minor changes to existing methods information that has a lot of nested elements, your best bet may be to edit the EML manually in a text editor (or in RStudio), otherwise there is a risk of accidentally overwriting nested elements with blank object classes, therefore losing methods information.</p>
<section id="adding-sampling-info-to-methods-section" class="level3">
<h3 class="anchored" data-anchor-id="adding-sampling-info-to-methods-section">Adding sampling info to methods section</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add method steps as new variables</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>step1 <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">methodStep</span>(<span class="at">description =</span> <span class="st">"text describing the methods used"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>stEx <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">studyExtent</span>(<span class="at">description =</span> <span class="st">"study extent description"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>samp <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">sampling</span>(<span class="at">studyExtent =</span> stEx,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">samplingDescription =</span> <span class="st">"sampling description text"</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># combine all methods steps and sampling info </span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>methods1 <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">methods</span>(<span class="at">methodStep =</span> step1, </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sampling =</span> samp)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>methods <span class="ot">&lt;-</span> methods1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="set-parties" class="level2">
<h2 class="anchored" data-anchor-id="set-parties">Set parties</h2>
<p>The <code>address</code>, <code>creator</code>, <code>contact</code>, and <code>associatedParty</code> classes can easily be created using functions from the <code>EML</code> package. However it is often easier to just edit this through the webform.</p>
<p>To add people, with their addresses, you need to add addresses as their own object class, which you then add to the <code>contact</code>, <code>creator</code>, or <code>associatedParty</code> classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>NCEASadd <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">address</span>( </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">deliveryPoint =</span> <span class="st">"735 State St #300"</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">city =</span> <span class="st">"Santa Barbara"</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">administrativeArea =</span> <span class="st">'CA'</span>, </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">postalCode =</span> <span class="st">'93101'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we use <code>eml_creator()</code> to set our data set <code>creator</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>JC_creator <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">creator</span>(<span class="at">individualName =</span> <span class="fu">list</span>(<span class="at">givenName =</span> <span class="st">"Jeanette"</span>, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">surName =</span> <span class="st">"Clark"</span>), </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">organization =</span> <span class="st">"NCEAS"</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">electronicMailAddress =</span> <span class="st">"jclark@nceas.ucsb.edu"</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">phone =</span> <span class="st">"123-456-7890"</span>, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">userId =</span> <span class="st">"https://orcid.org/WWWW-XXXX-YYYY-ZZZZ"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">address =</span> NCEASadd)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>creator <span class="ot">&lt;-</span> JC_creator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, we can set a single <code>contact</code> or multiple. In this case, there are two, so we set <code>doc$dataset$contact</code> as a list containing both of them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>JC_contact <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">contact</span>(<span class="at">individualName =</span> <span class="fu">list</span>(<span class="at">givenName =</span> <span class="st">"Jeanette"</span>, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">surName =</span> <span class="st">"Clark"</span>), </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">organization =</span> <span class="st">"NCEAS"</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">electronicMailAddress =</span> <span class="st">"jclark@nceas.ucsb.edu"</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">phone =</span> <span class="st">"123-456-7890"</span>,  </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">userId =</span> <span class="st">"https://orcid.org/WWWW-XXXX-YYYY-ZZZZ"</span>,<span class="at">id =</span> eml<span class="sc">$</span><span class="fu">userId</span>(<span class="at">directory =</span> eml<span class="sc">$</span>dir)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">address =</span> NCEASadd)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>JG_contact <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">contact</span>(<span class="at">individualName =</span> <span class="fu">list</span>(<span class="at">givenName =</span> <span class="st">"Jesse"</span>, </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">surName =</span> <span class="st">"Goldstein"</span>), </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">organization =</span> <span class="st">"NCEAS"</span>, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">electronicMailAddress =</span> <span class="st">"jgoldstein@nceas.ucsb.edu"</span>, </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">phone =</span> <span class="st">"123-456-7890"</span>,  </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">userId =</span> <span class="st">"https://orcid.org/WWWW-XXXX-YYYY-ZZZZ"</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">address =</span> NCEASadd)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>contact <span class="ot">&lt;-</span> <span class="fu">list</span>(JC_contact, JG_contact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, the <code>associatedParty</code>s are set. Note that <code>associatedParty</code>s MUST have a role defined, unlike <code>creator</code> or <code>contact</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>JG_ap <span class="ot">&lt;-</span> eml<span class="sc">$</span><span class="fu">associatedParty</span>(<span class="at">individualName =</span> <span class="fu">list</span>(<span class="at">givenName =</span> <span class="st">"Jesse"</span>, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">surName =</span> <span class="st">"Goldstein"</span>),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">organization =</span> <span class="st">"NCEAS"</span>, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">email =</span> <span class="st">"jgoldstein@nceas.ucsb.edu"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">electronicMailAddress =</span> <span class="st">"123-456-7890"</span>,  </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">address =</span> NCEASadd, </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">userId =</span> <span class="st">"https://orcid.org/WWWW-XXXX-YYYY-ZZZZ"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">role =</span> <span class="st">"metadataProvider"</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>associatedParty <span class="ot">&lt;-</span> JG_ap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-physical" class="level2">
<h2 class="anchored" data-anchor-id="set-physical">Set physical</h2>
<p>To set the <code>physical</code> aspects of a data object, use the following commands to build a <code>physical</code> object from a data <code>PID</code> that exists in your package. <strong>Remember to <a href="https://nceas.github.io/datateam-training/reference/set-dataone-nodes.html" target="_blank">set the member node</a> to test.arcticdata.io!</strong></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The word ‘physical’ derives from database systems, which distinguish the ‘logical’ model (e.g., what attributes are in a table, etc) from the physical model (how the data are written to a physical hard disk (basically, the serialization). so, we grouped metadata about the file (eg. dataformat, file size, file name) as written to disk in physical.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data_pid <span class="ot">&lt;-</span> <span class="fu">selectMember</span>(dp, <span class="at">name =</span> <span class="st">"sysmeta@fileName"</span>, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">value =</span> <span class="st">"your_file_name.csv"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>physical <span class="ot">&lt;-</span> arcticdatautils<span class="sc">::</span><span class="fu">pid_to_eml_physical</span>(d1c<span class="sc">@</span>mn, data_pid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>physical</code> must then be assigned to the data object.</p>
<p>Note that the above workflow only works if your data object already exists on the member node.</p>
</section>
<section id="set-the-project-section" class="level2">
<h2 class="anchored" data-anchor-id="set-the-project-section">Set the project section</h2>
<p>The project section in an EML document is automatically filled out by the metacatUI editor. It sets the project title and project personnel to the submission’s title and creators. Most of the time at least some of this information is incorrect and we need to update it.</p>
<p>Start by searching for the funding information using <a href="https://www.nsf.gov/awardsearch/" target="_blank">NSF’s award search</a>. This will give us the project title, abstract, and personnel - along with some additional metadata.</p>
<p>Using this information we will set the title, personnel, and funding number. For NSF funded projects prepend the funding number with “NSF”. If there are multiple awards associated with one dataset then additional <code>funding</code>, <code>title</code>, and <code>personnel</code> elements should be added to reflect the additional awards.</p>
<pre><code>doc$dataset$project$funding$para[[1]] &lt;- 'NSF 1503846'

doc$dataset$project$title[[1]] &lt;- 'Collaborative Research: Reconciling conflicting Arctic temperature and fire reconstructions using multi-proxy records from lake sediments north of the Brooks Range, Alaska

doc$dataset$project$personnel[[1]] &lt;- eml$personnel(individualName = eml$individualName(givenName = 'Yongsong', surName = 'Huang'),
                                                    role = 'Principal Investigator')
doc$dataset$project$personnel[[2]] &lt;- eml$personnel(individualName = eml$individualName(givenName = 'James', surName = 'Russell'),
                                                    role = 'co Principal Investigator')</code></pre>
<p>There is also a helper function <code>eml_nsf_to_project()</code> that can help do the searching for you. Just verify that the information retrieved is correct.</p>
<pre><code># update NSF awards data
awards &lt;- c("1311655", "1417987", "1417993") # list of award numbers
proj &lt;- eml_nsf_to_project(awards) #helper function

doc$dataset$project &lt;- proj</code></pre>
<p>On the web form right now only fills in the funding field. We need instructions on how to convert that to the new awards formatting until the form is updated to include these fields:</p>
<pre><code>project$award$funderName # required
project$award$title # required
project$award$awardNumber
project$award$funderIdentifier</code></pre>
<p>Information can be found in using the <a href="https://gitlab.com/crossref/open_funder_registry/-/tree/master" target="_blank">Open Funder Registry</a>. If a award title cannot be found you can use the dataset title.</p>
</section>
<section id="use-references" class="level2">
<h2 class="anchored" data-anchor-id="use-references">Use references</h2>
<p>References are a way to avoid repeating the same information multiple times in the same EML record. There are a few benefits to doing this, including:</p>
<ul>
<li>Making it clear that two things are the same (e.g., the creator is the same person as the contact, two entities have the exact same attributes)</li>
<li>Reducing the size on disk of EML records with highly redundant information</li>
<li>Faster read/write/validate with the R EML package</li>
</ul>
<p>You may want to use EML references if you have the following scenarios (not exhaustive):</p>
<ul>
<li>One person has multiple roles in the dataset (creator, contact, etc)</li>
<li>One or more entities shares all or some attributes</li>
</ul>
<section id="example-with-parties" class="level3">
<h3 class="anchored" data-anchor-id="example-with-parties">Example with parties</h3>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do not use references for creators as it is used for the citation information. The creators will not show up on the top of the dataset if it is a reference. Until this issue is resolved in NCEAS/metacat#926 we will need to keep this in account.</p>
</div>
</div>
<p>It’s very common to see the contact and creator referring to the same person with XML like this:</p>
<pre><code>&lt;eml packageId="my_test_doc" system="my_system" xsi:schemaLocation="eml://ecoinformatics.org/eml-2.1.1 eml.xsd"&gt;
  &lt;dataset&gt;
    &lt;creator&gt;
      &lt;individualName&gt;
        &lt;givenName&gt;Bryce&lt;/givenName&gt;
        &lt;surName&gt;Mecum&lt;/surName&gt;
      &lt;/individualName&gt;
    &lt;/creator&gt;
    &lt;contact&gt;
      &lt;individualName&gt;
        &lt;givenName&gt;Bryce&lt;/givenName&gt;
        &lt;surName&gt;Mecum&lt;/surName&gt;
      &lt;/individualName&gt;
    &lt;/contact&gt;
  &lt;/dataset&gt;
&lt;/eml&gt;</code></pre>
<p>So you see those two times Bryce Mecum is referenced there? If you mean to state that Bryce Mecum is the creator and contact for the dataset, this is a good start. But with just a name, there’s some ambiguity as to whether the creator and contact are truly the same person. Using references, we can remove all doubt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>creator[[<span class="dv">1</span>]]<span class="sc">$</span>id  <span class="ot">&lt;-</span> <span class="st">"reference_id"</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>contact <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">references =</span> <span class="st">"reference_id"</span>) </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(doc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;eml:eml xmlns:eml="eml://ecoinformatics.org/eml-2.1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:stmml="http://www.xml-cml.org/schema/stmml-1.1" packageId="id" system="system" xsi:schemaLocation="eml://ecoinformatics.org/eml-2.1.1/ eml.xsd"&gt;
  &lt;dataset&gt;
    &lt;title&gt;A Minimal Valid EML Dataset&lt;/title&gt;
    &lt;creator id="reference_id"&gt;
      &lt;individualName&gt;
        &lt;givenName&gt;Bryce&lt;/givenName&gt;
        &lt;surName&gt;Mecum&lt;/surName&gt;
      &lt;/individualName&gt;
    &lt;/creator&gt;
    &lt;contact&gt;
      &lt;references&gt;reference_id&lt;/references&gt;
    &lt;/contact&gt;
  &lt;/dataset&gt;
&lt;/eml:eml&gt;</code></pre>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The reference <code>id</code> needs to be unique within the EML record but doesn’t need to have meaning outside of that.</p>
</div>
</div>
</section>
<section id="example-with-attributes" class="level3">
<h3 class="anchored" data-anchor-id="example-with-attributes">Example with attributes</h3>
<p>To use references with attributes:</p>
<ol type="1">
<li>Add an attribute list to a data table</li>
<li>Add a reference id for that attribute list</li>
<li>Use references to add that information into the <code>attributeList</code>s of the other data tables</li>
</ol>
<p>For example, if all the data tables in our data package have the same attributes, we can set the attribute list for the first one, and use references for the rest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">1</span>]]<span class="sc">$</span>attributeList <span class="ot">&lt;-</span> attribute_list</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[<span class="dv">1</span>]]<span class="sc">$</span>attributeList<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="st">"shared_attributes"</span> <span class="co"># use any unique name for your id</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable)) {</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  doc<span class="sc">$</span>dataset<span class="sc">$</span>dataTable[[i]]<span class="sc">$</span>attributeList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">references =</span> <span class="st">"shared_attributes"</span>) <span class="co"># use the id you set above</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./explore_eml.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Explore EML</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./pi_correspondence.html" class="pagination-link">
        <span class="nav-page-text">PI Correspondence</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>